# Datawer
<h2> Нова Пошта
Опис задачі
Розробити сховище даних для аналізу діяльності служби міжнародних доставок із понад 200 відділеннями по всьому світу.
Відділення керують відправленнями різних товарів для багатьох сторонніх компаній. Поточна інформаційна система неоднорідна, тому кожне відділення окремо зберігає дані для власної діяльності.
Кожне відправлення обробляється одним відділенням. Відправка складається з одного або кількох маршрутів, і кожен маршрут має місце відправлення та призначення (місто, район, область і країна).

Керівництву необхідно проаналізувати глобальні потоки товарів, щоб вирішити, які відділення розширити або скоротити, і прийняти стратегічні бізнес-рішення.
Аналіз потоків товарів проводиться з урахуванням доходу, ваги (в кг) і обсягу поставленого товару. Зокрема, керівництво зацікавлене в тому, щоб проаналізувати доходи кожного відділення та порівняти їх з доходами кожного району міста, до якого належить відділення. Проводиться подальший аналіз рентабельності для різних категорій товарів і для різних типів перевезення (повітряний, залізничний, морський тощо).
Щоб вирішити, які відділення розширити або скоротити, керівництву необхідно проаналізувати маршрути доставки з точки зору доходу, обсягу та ваги товарів, що поставляються.
Зрештою, керівництву необхідно проаналізувати середній дохід, середню вагу та середній обсяг поставлених товарів у різні роки, півріччя, 4-місячні періоди, квартали, 2-місячні періоди, місяці, дні місяця та дні тижня.
Нижче наведено деякі з частих запитів, які цікавлять керівництво:
Розглядаючи тільки українські маршрути, для кожної категорії товарів і для кожного року виберіть середньоденний дохід за кожен місяць і загальний місячний дохід з початку року.
Беручи до уваги лише авіаперевізників, виберіть середньорічний дохід на одиницю обсягу для кожної області призначення та відсоток такого доходу порівняно із середньорічним доходом на одиницю обсягу країни призначення.
У 2022 році для кожного маршруту в розрізі області відправлення та призначення вибрати середньомісячний дохід на одиницю ваги (у кг) доставленого вантажу та середньоденний дохід за кожен місяць для вантажу, доставленого на цьому маршруті.
Для кожного району відділення та типу перевізника виберіть загальний дохід за кожен місяць і загальний обсяг товарів, доставлених за кожен місяць. Розташуйте результати відповідно до загального місячного обсягу (найвищий 1-й).
У 2021 році для кожного маршруту в розрізі міста відправлення та призначення вибрати середньорічний дохід на одиницю ваги доставленого вантажу та середньодобовий дохід для кожного розглянутого маршруту.
У 2021 і 2022 роках, враховуючи лише морські перевезення, виберіть піврічний середній дохід на одиницю об’єму для кожного відділення та для кожної області відправлення, а також піврічний середній дохід на одиницю ваги.
Для кожного міста відправлення та для кожного району відділення виберіть дохід за 4-місячний період і загальний обсяг поставлених товарів для кожного 4-місячного періоду.
Завдання
У сховищі даних буде зберігатися інформація 2020, 2021, 2022 і 2023 років. Відома така інформація:
Категорії товарів: ~20
Відділення: ~200
Райони відділень: ~50
Різні типи перевезення: ~5
Міста: ~1000
Райони: ~200
Області: ~100
Країни: ~20
Спроектувати сховище даних для вирішення описаних задач. Зокрема, сховище повинно забезпечувати ефективне виконання всіх запитів, описаних вище.
Напишіть часті запити (a), (c) і (d) з «опису задачі», використовуючи розширену мову SQL.

</h2>
